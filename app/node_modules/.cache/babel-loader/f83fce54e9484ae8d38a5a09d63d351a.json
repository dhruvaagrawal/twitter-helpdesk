{"ast":null,"code":"exports.replaceDollarWithPercentPair = replaceDollarWithPercentPair;\nexports.convertToSetCommand = convertToSetCommand;\nexports.convertToSetCommands = convertToSetCommands;\n\nfunction convertToSetCommand(key, value) {\n  var line = \"\";\n  key = key || \"\";\n  key = key.trim();\n  value = value || \"\";\n  value = value.trim();\n\n  if (key && value && value.length > 0) {\n    line = \"@SET \" + key + \"=\" + replaceDollarWithPercentPair(value) + \"\\r\\n\";\n  }\n\n  return line;\n}\n\nfunction extractVariableValuePairs(declarations) {\n  var pairs = {};\n  declarations.map(function (declaration) {\n    var split = declaration.split(\"=\");\n    pairs[split[0]] = split[1];\n  });\n  return pairs;\n}\n\nfunction convertToSetCommands(variableString) {\n  var variableValuePairs = extractVariableValuePairs(variableString.split(\" \"));\n  var variableDeclarationsAsBatch = \"\";\n  Object.keys(variableValuePairs).forEach(function (key) {\n    variableDeclarationsAsBatch += convertToSetCommand(key, variableValuePairs[key]);\n  });\n  return variableDeclarationsAsBatch;\n}\n\nfunction replaceDollarWithPercentPair(value) {\n  var dollarExpressions = /\\$\\{?([^\\$@#\\?\\- \\t{}:]+)\\}?/g;\n  var result = \"\";\n  var startIndex = 0;\n\n  do {\n    var match = dollarExpressions.exec(value);\n\n    if (match) {\n      var betweenMatches = value.substring(startIndex, match.index) || \"\";\n      result += betweenMatches + \"%\" + match[1] + \"%\";\n      startIndex = dollarExpressions.lastIndex;\n    }\n  } while (dollarExpressions.lastIndex > 0);\n\n  result += value.substr(startIndex);\n  return result;\n}","map":null,"metadata":{},"sourceType":"script"}