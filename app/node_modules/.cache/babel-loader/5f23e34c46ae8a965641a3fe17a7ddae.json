{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{Link}from'react-router-dom';import{makeStyles}from'@material-ui/core/styles';import{message,Typography,Form,Button,Checkbox,Row,Col,Select,Card}from'antd';import{CloudUploadOutlined,LeftCircleOutlined,RightCircleOutlined}from'@ant-design/icons';import axios from'axios';import{v4 as uuidv4}from'uuid';import readXlsxFile from'read-excel-file';import{ES_BASE_URL,ES_BULK_QUERY,ES_PASSWORD,ES_USERNAME,API_BASE_URL,API_ES_DATA_POST_URL}from'constants/ApiConstant';import{StyledButton,StyledNavButton}from'constants/StyledComponents';import{APP_PREFIX_PATH}from'configs/AppConfig';var Title=Typography.Title;var Option=Select.Option;var useStyles=makeStyles({table:{minWidth:650}});var FileUploadForm=function FileUploadForm(props){console.log(props);// ---------------------------- VARIABLE ASSIGNMENT ---------------------------- //\nvar fileReader;var newArr=[];var checkedLanguages=[];var selectedOptions=[];var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),rows=_useState4[0],setRows=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),visible=_useState6[0],setVisible=_useState6[1];// const [ show, setShow ] = useState(false)\nvar _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),buttonVisible=_useState8[0],setButtonVisible=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),checked=_useState10[0],setChecked=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),createTable=_useState12[0],setCreateTable=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),languages=_useState14[0],setLanguages=_useState14[1];var classes=useStyles();// Create a reference to the hidden file input element\nvar hiddenFileInput=React.useRef(null);var formItemLayout={labelCol:{span:6},wrapperCol:{span:14}};var map={'Product':'product','Stage':'stage','Type':'type','Level':'level','Category':'category','Content':'content','Vendor':'vendor','Languages':'languages','Status':'status'};// --------------------------------------------------------------------- //\n// ------------------------ FUNCTION ASSIGNMENT ------------------------ //\n// --------------------------------------------------------------------- //\nvar showButtons=function showButtons(){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(Form.Item,{style:{display:'flex',justifyContent:'center',alignItems:'center',marginTop:0,marginBottom:0,paddingtop:0,paddingTop:0}},/*#__PURE__*/React.createElement(Row,null,renderLanguages()))),/*#__PURE__*/React.createElement(StyledButton,{onClick:handleClick,style:{marginTop:'7.5%'}},/*#__PURE__*/React.createElement(CloudUploadOutlined,{style:{marginRight:'2%'}}),\" Upload File\"),/*#__PURE__*/React.createElement(Row,{style:{marginTop:'12.5%',display:'flex',justifyContent:'center',alignItems:'center'}},/*#__PURE__*/React.createElement(StyledNavButton,{style:{marginRight:'3%'}},/*#__PURE__*/React.createElement(LeftCircleOutlined,{style:{marginRight:'2%'}}),\"Go to recommendations\"),/*#__PURE__*/React.createElement(Link,{to:\"\".concat(APP_PREFIX_PATH,\"/journeys/journey-ivr/transaction\")},/*#__PURE__*/React.createElement(StyledNavButton,null,\"Go to transactions\",/*#__PURE__*/React.createElement(RightCircleOutlined,{style:{marginLeft:'2%'}})))));};var handleClick=function handleClick(){hiddenFileInput.current.click();};var onChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var tableArray,customer_name,formData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();tableArray=[];customer_name='ICICI';formData=new FormData();setFile(e.target.files[0]);_context2.next=7;return readXlsxFile(e.target.files[0],{map:map}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2){var rows;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:rows=_ref2.rows;rows.forEach(function(row){return row.id=uuidv4(),row.channel='smartVoice',row.customer_name=customer_name,row.content_name=\"\".concat(customer_name,\"-\").concat(row.stage,\"-\").concat(row.product,\"-\").concat(row.category,\"-\").concat(row.channel),row.language=languages,row.status='Client Approved',row.last_updated_on=new Date(),row.last_updated_by='Administrator',row.version=1;});formData.append('client_data',rows);props.esData(rows);console.log(formData);_context.next=7;return axios({method:'post',baseURL:API_BASE_URL,url:API_ES_DATA_POST_URL,data:formData}).then(function(res){return console.log(\"Connection with STATUS \".concat(res.status,\" has been established.\"));}).catch(function(err){if(err.response){console.log(err.response);console.log(err.response.data);console.log(err.response.status);console.log(err.response.headers);}else if(err.request){console.log(err.request);}else{console.log('Error',err.message);}console.log(err.config);});case 7:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref3.apply(this,arguments);};}());case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function onChange(_x){return _ref.apply(this,arguments);};}();var onSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case\"end\":return _context3.stop();}}},_callee3);}));return function onSubmit(_x3){return _ref4.apply(this,arguments);};}();var onCheck=function onCheck(event){checkedLanguages.push(event.target.value);setLanguages(function(prevLanguages){return prevLanguages.concat(checkedLanguages);});};// const onSelect = event => {\n//     selectedOptions.push(event.value)\n//     console.log(selectedOptions)\n// }\nvar renderLanguages=function renderLanguages(){var languages=['English','Hindi','Tamil','Telugu','Kannada','Marathi','Gujarati','Bengali','Punjabi','Malayalam'];return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Form.Item,{name:\"language\",label:\"Language\"},languages.map(function(language){return/*#__PURE__*/React.createElement(Checkbox.Group,{className:\"pl-3 mt-1\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Checkbox,{value:language,style:{lineHeight:'32px'},onChange:onCheck},language)));})));};// const showTableHeaders = array => {\n//     newArr = array[0]\n//     console.log(newArr)\n//     return (\n//         <>\n//         { newArr.map( (num, index) => (\n//             <Form.Item\n//                 name={ num }\n//                 label={ num }\n//                 hasFeedback\n//             >\n//                 <Row>\n//                     <Select key={ index } labelInValue placeholder={`Please enter ${ num }`} onSelect={ onSelect }>\n//                         { newArr.map( (num, index) => {\n//                             return <Option key={ index } value={ num }>{ num }</Option>\n//                         }) }\n//                     </Select>\n//                 </Row>\n//             </Form.Item>\n//         ))}\n//         </>\n//     )\n// }\n// --------------------------------------------------------------------- //\n// --------------------------------------------------------------------- //\n// --------------------------------------------------------------------- //\nreturn/*#__PURE__*/React.createElement(Form,Object.assign({name:\"validate_other\"},formItemLayout,{onFinish:onSubmit,textAlign:\"center\",style:buttonVisible?{height:'500px'}:{height:'100%'}}),/*#__PURE__*/React.createElement(Form.Item,{justify:\"center\",style:{textAlign:'center',marginTop:'1%'}},/*#__PURE__*/React.createElement(Title,{level:1},\"Upload Transactions\")),checked&&/*#__PURE__*/React.createElement(Button,{htmlType:\"submit\",variant:\"contained\",type:\"primary\",style:{width:'100%',height:'3rem',fontSize:'1.45rem'}},\"Create Transactions\"),/*#__PURE__*/React.createElement(Form.Item,{style:{display:'flex',justifyContent:'center',alignItems:'center',textAlign:'center'}},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",onChange:onChange,ref:hiddenFileInput,style:{display:'none'}}),buttonVisible?showButtons():/*#__PURE__*/React.createElement(Title,{level:3},\"Please map the headings\")),console.log(createTable));};export default FileUploadForm;","map":{"version":3,"sources":["/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/src/views/app-views/ops-admin/FileUploadForm.js"],"names":["React","useState","Link","makeStyles","message","Typography","Form","Button","Checkbox","Row","Col","Select","Card","CloudUploadOutlined","LeftCircleOutlined","RightCircleOutlined","axios","v4","uuidv4","readXlsxFile","ES_BASE_URL","ES_BULK_QUERY","ES_PASSWORD","ES_USERNAME","API_BASE_URL","API_ES_DATA_POST_URL","StyledButton","StyledNavButton","APP_PREFIX_PATH","Title","Option","useStyles","table","minWidth","FileUploadForm","props","console","log","fileReader","newArr","checkedLanguages","selectedOptions","file","setFile","rows","setRows","visible","setVisible","buttonVisible","setButtonVisible","checked","setChecked","createTable","setCreateTable","languages","setLanguages","classes","hiddenFileInput","useRef","formItemLayout","labelCol","span","wrapperCol","map","showButtons","display","justifyContent","alignItems","marginTop","marginBottom","paddingtop","paddingTop","renderLanguages","handleClick","marginRight","marginLeft","current","click","onChange","e","preventDefault","tableArray","customer_name","formData","FormData","target","files","then","forEach","row","id","channel","content_name","stage","product","category","language","status","last_updated_on","Date","last_updated_by","version","append","esData","method","baseURL","url","data","res","catch","err","response","headers","request","config","onSubmit","onCheck","event","push","value","prevLanguages","concat","lineHeight","height","textAlign","width","fontSize"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { Link } from 'react-router-dom'\nimport { makeStyles } from '@material-ui/core/styles';\nimport { message, Typography, Form, Button, Checkbox, Row, Col, Select, Card } from 'antd'\nimport { CloudUploadOutlined, LeftCircleOutlined, RightCircleOutlined } from '@ant-design/icons'\nimport axios from 'axios'\nimport { v4 as uuidv4 } from 'uuid';\nimport readXlsxFile from 'read-excel-file'\nimport { ES_BASE_URL, ES_BULK_QUERY, ES_PASSWORD, ES_USERNAME, API_BASE_URL, API_ES_DATA_POST_URL } from 'constants/ApiConstant'\nimport { StyledButton, StyledNavButton } from 'constants/StyledComponents'\nimport { APP_PREFIX_PATH } from 'configs/AppConfig'\n\nconst { Title } = Typography\nconst { Option } = Select\n\nconst useStyles = makeStyles({\n    table: {\n        minWidth: 650,\n    },\n});\n\nconst FileUploadForm = props => {\n\n    console.log(props)\n\n    // ---------------------------- VARIABLE ASSIGNMENT ---------------------------- //\n\n    let fileReader;\n\n    let newArr = []\n\n    let checkedLanguages = []\n    let selectedOptions = []\n\n    const [ file, setFile ] = useState(null)\n    const [ rows, setRows ] = useState(null)\n    const [ visible, setVisible ] = useState(false)\n    // const [ show, setShow ] = useState(false)\n    const [ buttonVisible, setButtonVisible ] = useState(true)\n    const [ checked, setChecked ] = useState(false)\n    const [ createTable, setCreateTable ] = useState([])\n    const [ languages, setLanguages ] = useState([])\n\n    const classes = useStyles()\n\n    // Create a reference to the hidden file input element\n    const hiddenFileInput = React.useRef(null);\n\n    const formItemLayout = {\n        labelCol: {\n            span: 6,\n        },\n        wrapperCol: {\n            span: 14,\n        },\n    }; \n\n    const map = {\n        'Product': 'product',\n        'Stage': 'stage',\n        'Type': 'type',\n        'Level': 'level',\n        'Category': 'category',\n        'Content': 'content',\n        'Vendor': 'vendor',\n        'Languages': 'languages',\n        'Status': 'status'\n    }\n\n\n    // --------------------------------------------------------------------- //\n    // ------------------------ FUNCTION ASSIGNMENT ------------------------ //\n    // --------------------------------------------------------------------- //\n\n    const showButtons = () => {\n\n        return (\n            <>\n                <Card>\n                    <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', marginTop: 0, marginBottom: 0, paddingtop: 0, paddingTop: 0 }}>\n                        <Row>\n                            { renderLanguages() }\n                        </Row>\n                    </Form.Item>\n                </Card>\n                <StyledButton onClick={ handleClick } style={{ marginTop: '7.5%' }}><CloudUploadOutlined style={{ marginRight: '2%' }} /> Upload File</StyledButton>\n                <Row style={{ marginTop: '12.5%', display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\n                    <StyledNavButton style={{ marginRight: '3%'}}><LeftCircleOutlined style={{ marginRight: '2%' }} />Go to recommendations</StyledNavButton>\n                    <Link to={`${APP_PREFIX_PATH}/journeys/journey-ivr/transaction`}>\n                        <StyledNavButton>Go to transactions<RightCircleOutlined style={{ marginLeft: '2%' }} /></StyledNavButton>\n                    </Link>\n                </Row>\n            </>\n        )\n    }\n\n    const handleClick = () => {\n        hiddenFileInput.current.click()\n    }\n\t\n    const onChange = async (e) => {\n        e.preventDefault()\n        let tableArray = []\n        let customer_name = 'ICICI'\n        const formData = new FormData();\n        setFile(e.target.files[0])\n        await readXlsxFile(e.target.files[0], { map })\n        .then( async ({ rows }) => {\n            rows.forEach( row => (\n                row.id = uuidv4(),\n                row.channel = 'smartVoice',\n                row.customer_name = customer_name,\n                row.content_name = `${customer_name}-${row.stage}-${row.product}-${row.category}-${row.channel}`,\n                row.language = languages,\n                row.status = 'Client Approved',\n                row.last_updated_on = new Date(),\n                row.last_updated_by = 'Administrator',\n                row.version = 1\n            ))\n            formData.append('client_data', rows)\n            props.esData(rows)\n            console.log(formData)\n            await axios({\n                method: 'post',\n                baseURL: API_BASE_URL,\n                url: API_ES_DATA_POST_URL,\n                data: formData\n            })\n            .then( res => console.log(`Connection with STATUS ${res.status} has been established.`))\n            .catch( function(err) {\n                if (err.response) {\n                    console.log(err.response)\n                    console.log(err.response.data)\n                    console.log(err.response.status)\n                    console.log(err.response.headers)\n                } else if (err.request) {\n                    console.log(err.request)\n                } else {\n                    console.log('Error', err.message);\n                }\n                console.log(err.config);\n            })\n        })\n        // .then( function(res) {\n        //     for (let i = 0; i < 3; i++) {\n        //         tableArray.push(res[i])\n        //     } \n        //     console.log(tableArray)\n        //     setCreateTable(tableArray)\n        //     setVisible(true)\n        //     setButtonVisible(false)\n        // })\n    }\n    \n    const onSubmit = async (e) => {\n        // let res = await uploadFile(file);\n        // console.log(res.data);\n        // checkedLanguages = []\n        // selectedOptions = []\n        // message.success('Your file was successfully submitted and is now being processed')\n\t}\n      \n    const onCheck = event => {\n        checkedLanguages.push(event.target.value)\n        setLanguages(prevLanguages => prevLanguages.concat(checkedLanguages))\n    }\n\n    // const onSelect = event => {\n    //     selectedOptions.push(event.value)\n    //     console.log(selectedOptions)\n    // }\n    \n    const renderLanguages = () => {\n        const languages = ['English', 'Hindi', 'Tamil', 'Telugu', 'Kannada', 'Marathi', 'Gujarati', 'Bengali', 'Punjabi', 'Malayalam']\n\n        return (\n            <>\n                <Form.Item name=\"language\" label=\"Language\">\n                        { languages.map( language => (\n                            <Checkbox.Group className=\"pl-3 mt-1\">\n                                <Col>\n                                    <Checkbox value={ language } style={{ lineHeight: '32px' }} onChange={ onCheck }>{ language }</Checkbox>\n                                </Col>\n                            </Checkbox.Group>\n                        )) }\n                </Form.Item>\n            </>\n        )\n    }\n    \n    // const showTableHeaders = array => {\n\n    //     newArr = array[0]\n\n    //     console.log(newArr)\n        \n    //     return (\n    //         <>\n    //         { newArr.map( (num, index) => (\n    //             <Form.Item\n    //                 name={ num }\n    //                 label={ num }\n    //                 hasFeedback\n    //             >\n    //                 <Row>\n    //                     <Select key={ index } labelInValue placeholder={`Please enter ${ num }`} onSelect={ onSelect }>\n    //                         { newArr.map( (num, index) => {\n    //                             return <Option key={ index } value={ num }>{ num }</Option>\n    //                         }) }\n    //                     </Select>\n    //                 </Row>\n    //             </Form.Item>\n    //         ))}\n    //         </>\n    //     )\n    // }\n\n    // --------------------------------------------------------------------- //\n    // --------------------------------------------------------------------- //\n    // --------------------------------------------------------------------- //\n\n\treturn (\n        <Form\n            name=\"validate_other\"\n            { ...formItemLayout }\n            onFinish={ onSubmit }\n            textAlign=\"center\"\n            style={ buttonVisible ? { height: '500px' } : { height: '100%' }}\n        >\n\t\t\t<Form.Item justify=\"center\" style={{ textAlign: 'center', marginTop: '1%' }}>\n                <Title level={1}>Upload Transactions</Title>\n            </Form.Item>\n            { checked && <Button htmlType=\"submit\" variant=\"contained\" type=\"primary\" style={{ width: '100%', height: '3rem', fontSize: '1.45rem' }}>Create Transactions</Button> }\n            <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', textAlign: 'center' }}>\n\t\t\t    <input type=\"file\" onChange={ onChange } ref={ hiddenFileInput }  style={{ display: 'none' }} />\n                { buttonVisible ? showButtons() : <Title level={3}>Please map the headings</Title>}\n            </Form.Item>\n            {/* <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }} className=\"mt-5\">\n                    <Row>\n                        { visible && showTableHeaders(createTable) }\n                    </Row>\n            </Form.Item> */}\n            { console.log(createTable) }\n\t\t</Form>\n\t)\n        \n}\nexport default FileUploadForm"]},"metadata":{},"sourceType":"module"}