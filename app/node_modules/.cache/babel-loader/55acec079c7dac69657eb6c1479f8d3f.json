{"ast":null,"code":"var assert = require('assert');\n\nvar toNerfDart = require('./nerf-dart.js');\n\nmodule.exports = setCredentialsByURI;\n\nfunction setCredentialsByURI(uri, c) {\n  assert(uri && typeof uri === 'string', 'registry URL is required');\n  assert(c && typeof c === 'object', 'credentials are required');\n  var nerfed = toNerfDart(uri);\n\n  if (c.token) {\n    this.set(nerfed + ':_authToken', c.token, 'user');\n    this.del(nerfed + ':_password', 'user');\n    this.del(nerfed + ':username', 'user');\n    this.del(nerfed + ':email', 'user');\n    this.del(nerfed + ':always-auth', 'user');\n  } else if (c.username || c.password || c.email) {\n    assert(c.username, 'must include username');\n    assert(c.password, 'must include password');\n    assert(c.email, 'must include email address');\n    this.del(nerfed + ':_authToken', 'user');\n    var encoded = Buffer.from(c.password, 'utf8').toString('base64');\n    this.set(nerfed + ':_password', encoded, 'user');\n    this.set(nerfed + ':username', c.username, 'user');\n    this.set(nerfed + ':email', c.email, 'user');\n\n    if (c.alwaysAuth !== undefined) {\n      this.set(nerfed + ':always-auth', c.alwaysAuth, 'user');\n    } else {\n      this.del(nerfed + ':always-auth', 'user');\n    }\n  } else {\n    throw new Error('No credentials to set.');\n  }\n}","map":null,"metadata":{},"sourceType":"script"}