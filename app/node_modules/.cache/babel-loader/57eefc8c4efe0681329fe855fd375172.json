{"ast":null,"code":"import _regeneratorRuntime from\"/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState}from'react';import{makeStyles}from'@material-ui/core/styles';import{message,Typography,Form,Button,Checkbox,Row,Col,Select}from'antd';import{CloudUploadOutlined,LeftCircleOutlined,RightCircleOutlined}from'@ant-design/icons';import axios from'axios';import{ES_BASE_URL,ES_BULK_QUERY,ES_PASSWORD,ES_USERNAME}from'constants/ApiConstant';import readXlsxFile from'read-excel-file';import{StyledButton,StyledNavButton}from'constants/StyledComponents';var Title=Typography.Title;var Option=Select.Option;var useStyles=makeStyles({table:{minWidth:650}});var FileUploadForm=function FileUploadForm(props){// ---------------------------- VARIABLE ASSIGNMENT ---------------------------- //\nvar fileReader;var newArr=[];var checkedLanguages=[];var selectedOptions=[];var _useState=useState(null),_useState2=_slicedToArray(_useState,2),file=_useState2[0],setFile=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),rows=_useState4[0],setRows=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),visible=_useState6[0],setVisible=_useState6[1];// const [ show, setShow ] = useState(false)\nvar _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),buttonVisible=_useState8[0],setButtonVisible=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),checked=_useState10[0],setChecked=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),createTable=_useState12[0],setCreateTable=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),languages=_useState14[0],setLanguages=_useState14[1];var classes=useStyles();// Create a reference to the hidden file input element\nvar hiddenFileInput=React.useRef(null);var formItemLayout={labelCol:{span:6},wrapperCol:{span:14}};var map={'Product':'product','Segment':'segment','Type':'type','Level':'level','Category':'category','Content':'content','Vendor':'vendor','Languages':'languages','Status':'status'};// --------------------------------------------------------------------- //\n// ------------------------ FUNCTION ASSIGNMENT ------------------------ //\n// --------------------------------------------------------------------- //\nvar showButtons=function showButtons(props){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(StyledButton,{onClick:handleClick,style:{marginTop:'7.5%'}},/*#__PURE__*/React.createElement(CloudUploadOutlined,{style:{marginRight:'2%'}}),\" Upload File\"),/*#__PURE__*/React.createElement(Row,{style:{marginTop:'12.5%',display:'flex',justifyContent:'center',alignItems:'center'}},/*#__PURE__*/React.createElement(StyledNavButton,{style:{marginRight:'3%'}},/*#__PURE__*/React.createElement(LeftCircleOutlined,{style:{marginRight:'2%'}}),\"Go to recommendations\"),/*#__PURE__*/React.createElement(StyledNavButton,null,\"Go to transactions\",/*#__PURE__*/React.createElement(RightCircleOutlined,{style:{marginLeft:'2%'}}))));};var handleClick=function handleClick(){hiddenFileInput.current.click();};var onChange=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var tableArray,formData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:e.preventDefault();tableArray=[];formData=new FormData();setFile(e.target.files[0]);_context2.next=6;return readXlsxFile(e.target.files[0],{map:map}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2){var rows;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:rows=_ref2.rows;rows.forEach(function(row){return row.languages=languages,row.status='Client Approved';});formData.append('client_data',rows);console.log(formData);_context.next=6;return axios({method:'post',baseURL:ES_BASE_URL,url:ES_BULK_QUERY,data:'',auth:{username:ES_USERNAME,password:ES_PASSWORD}}).then(function(res){return console.log(\"Connection with STATUS \".concat(res.status,\" has been established.\"));}).catch(function(err){if(err.response){console.log(err.response);console.log(err.response.data);console.log(err.response.status);console.log(err.response.headers);}else if(err.request){console.log(err.request);}else{console.log('Error',err.message);}console.log(err.config);});case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x2){return _ref3.apply(this,arguments);};}());case 6:case\"end\":return _context2.stop();}}},_callee2);}));return function onChange(_x){return _ref.apply(this,arguments);};}();// const uploadFile = async (file) => {\n//     const formData = new FormData();\n//     formData.append('file', file)\n//     let res =  await axios.post(FILE_UPLOAD_URL, formData, {\n//         headers: {\n//             'content-type': 'multipart/form-data'\n//         }\n// \t})\n// \treturn res\n// }\nvar onSubmit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(e){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:case\"end\":return _context3.stop();}}},_callee3);}));return function onSubmit(_x3){return _ref4.apply(this,arguments);};}();var onCheck=function onCheck(event){checkedLanguages.push(event.target.value);setLanguages(function(prevLanguages){return prevLanguages.concat(checkedLanguages);});};// const onSelect = event => {\n//     selectedOptions.push(event.value)\n//     console.log(selectedOptions)\n// }\nvar renderLanguages=function renderLanguages(){var languages=['English','Hindi','Tamil','Telugu','Kannada','Marathi','Gujarati','Bengali','Punjabi','Malayalam'];return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Form.Item,{name:\"language\",label:\"Language\"},languages.map(function(language){return/*#__PURE__*/React.createElement(Checkbox.Group,{className:\"pl-3 mt-1\"},/*#__PURE__*/React.createElement(Col,null,/*#__PURE__*/React.createElement(Checkbox,{value:language,style:{lineHeight:'32px'},onChange:onCheck},language)));})));};// const showTableHeaders = array => {\n//     newArr = array[0]\n//     console.log(newArr)\n//     return (\n//         <>\n//         { newArr.map( (num, index) => (\n//             <Form.Item\n//                 name={ num }\n//                 label={ num }\n//                 hasFeedback\n//             >\n//                 <Row>\n//                     <Select key={ index } labelInValue placeholder={`Please enter ${ num }`} onSelect={ onSelect }>\n//                         { newArr.map( (num, index) => {\n//                             return <Option key={ index } value={ num }>{ num }</Option>\n//                         }) }\n//                     </Select>\n//                 </Row>\n//             </Form.Item>\n//         ))}\n//         </>\n//     )\n// }\n// --------------------------------------------------------------------- //\n// --------------------------------------------------------------------- //\n// --------------------------------------------------------------------- //\nreturn/*#__PURE__*/React.createElement(Form,Object.assign({name:\"validate_other\"},formItemLayout,{onFinish:onSubmit,textAlign:\"center\",style:buttonVisible?{height:'500px'}:{height:'100%'}}),/*#__PURE__*/React.createElement(Form.Item,{justify:\"center\",style:{textAlign:'center',marginTop:'1%',marginBottom:'1%'}},/*#__PURE__*/React.createElement(Title,{level:1},\"Upload Transactions\")),/*#__PURE__*/React.createElement(Form.Item,{style:{display:'flex',justifyContent:'center',alignItems:'center'}},checked&&/*#__PURE__*/React.createElement(Button,{htmlType:\"submit\",variant:\"contained\",type:\"primary\",style:{width:'100%',height:'3rem',fontSize:'1.45rem'}},\"Create Transactions\")),/*#__PURE__*/React.createElement(Form.Item,{style:{display:'flex',justifyContent:'center',alignItems:'center',textAlign:'center'}},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",onChange:onChange,ref:hiddenFileInput,style:{display:'none'}}),buttonVisible?showButtons():/*#__PURE__*/React.createElement(Title,{level:3},\"Please map the headings\")),/*#__PURE__*/React.createElement(Form.Item,{style:{display:'flex',justifyContent:'center',alignItems:'center'},className:\"mt-5\"},/*#__PURE__*/React.createElement(Row,null,renderLanguages())),/*#__PURE__*/React.createElement(Form.Item,{style:{display:'flex',justifyContent:'center',alignItems:'center'}},visible&&/*#__PURE__*/React.createElement(Button,{htmlType:\"submit\",variant:\"contained\",type:\"primary\",style:{width:'100%',height:'3rem',fontSize:'1.45rem'}},\"Create Transactions\")));};export default FileUploadForm;","map":{"version":3,"sources":["/Users/dhruvaagrawal/Desktop/Work/Spocto/CMS/app/src/views/app-views/ops-admin/FileUploadForm.js"],"names":["React","useState","makeStyles","message","Typography","Form","Button","Checkbox","Row","Col","Select","CloudUploadOutlined","LeftCircleOutlined","RightCircleOutlined","axios","ES_BASE_URL","ES_BULK_QUERY","ES_PASSWORD","ES_USERNAME","readXlsxFile","StyledButton","StyledNavButton","Title","Option","useStyles","table","minWidth","FileUploadForm","props","fileReader","newArr","checkedLanguages","selectedOptions","file","setFile","rows","setRows","visible","setVisible","buttonVisible","setButtonVisible","checked","setChecked","createTable","setCreateTable","languages","setLanguages","classes","hiddenFileInput","useRef","formItemLayout","labelCol","span","wrapperCol","map","showButtons","handleClick","marginTop","marginRight","display","justifyContent","alignItems","marginLeft","current","click","onChange","e","preventDefault","tableArray","formData","FormData","target","files","then","forEach","row","status","append","console","log","method","baseURL","url","data","auth","username","password","res","catch","err","response","headers","request","config","onSubmit","onCheck","event","push","value","prevLanguages","concat","renderLanguages","language","lineHeight","height","textAlign","marginBottom","width","fontSize"],"mappings":"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","sourcesContent":["import React, { useState } from 'react'\nimport { makeStyles } from '@material-ui/core/styles';\nimport { message, Typography, Form, Button, Checkbox, Row, Col, Select } from 'antd'\nimport { CloudUploadOutlined, LeftCircleOutlined, RightCircleOutlined } from '@ant-design/icons'\nimport axios from 'axios'\nimport { ES_BASE_URL, ES_BULK_QUERY, ES_PASSWORD, ES_USERNAME } from 'constants/ApiConstant'\nimport readXlsxFile from 'read-excel-file'\nimport { StyledButton, StyledNavButton } from 'constants/StyledComponents'\n\nconst { Title } = Typography\nconst { Option } = Select\n\nconst useStyles = makeStyles({\n    table: {\n        minWidth: 650,\n    },\n});\n\nconst FileUploadForm = props => {\n\n    // ---------------------------- VARIABLE ASSIGNMENT ---------------------------- //\n\n    let fileReader;\n\n    let newArr = []\n\n    let checkedLanguages = []\n    let selectedOptions = []\n\n    const [ file, setFile ] = useState(null)\n    const [ rows, setRows ] = useState(null)\n    const [ visible, setVisible ] = useState(false)\n    // const [ show, setShow ] = useState(false)\n    const [ buttonVisible, setButtonVisible ] = useState(true)\n    const [ checked, setChecked ] = useState(false)\n    const [ createTable, setCreateTable ] = useState([])\n    const [ languages, setLanguages ] = useState([])\n\n    const classes = useStyles()\n\n    // Create a reference to the hidden file input element\n    const hiddenFileInput = React.useRef(null);\n\n    const formItemLayout = {\n        labelCol: {\n            span: 6,\n        },\n        wrapperCol: {\n            span: 14,\n        },\n    }; \n\n    const map = {\n        'Product': 'product',\n        'Segment': 'segment',\n        'Type': 'type',\n        'Level': 'level',\n        'Category': 'category',\n        'Content': 'content',\n        'Vendor': 'vendor',\n        'Languages': 'languages',\n        'Status': 'status'\n    }\n\n\n    // --------------------------------------------------------------------- //\n    // ------------------------ FUNCTION ASSIGNMENT ------------------------ //\n    // --------------------------------------------------------------------- //\n\n\n    const showButtons = props => {\n\n        return (\n            <>\n                <StyledButton onClick={ handleClick } style={{ marginTop: '7.5%' }}><CloudUploadOutlined style={{ marginRight: '2%' }} /> Upload File</StyledButton>\n                <Row style={{ marginTop: '12.5%', display: 'flex', justifyContent: 'center', alignItems: 'center'}}>\n                    <StyledNavButton style={{ marginRight: '3%'}}><LeftCircleOutlined style={{ marginRight: '2%' }} />Go to recommendations</StyledNavButton>\n                    <StyledNavButton>Go to transactions<RightCircleOutlined style={{ marginLeft: '2%' }} /></StyledNavButton>\n                </Row>\n            </>\n        )\n    }\n\n    const handleClick = () => {\n        hiddenFileInput.current.click()\n    }\n\t\n    const onChange = async (e) => {\n        e.preventDefault()\n        let tableArray = []\n        const formData = new FormData();\n        setFile(e.target.files[0])\n        await readXlsxFile(e.target.files[0], { map })\n        .then( async ({ rows }) => {\n            rows.forEach( row => (\n                row.languages = languages,\n                row.status = 'Client Approved'\n            ))\n            formData.append('client_data', rows)\n            console.log(formData)\n            await axios({\n                method: 'post',\n                baseURL: ES_BASE_URL,\n                url: ES_BULK_QUERY,\n                data: '',\n                auth: {\n                    username: ES_USERNAME,\n                    password: ES_PASSWORD\n                }\n            })\n            .then( res => console.log(`Connection with STATUS ${res.status} has been established.`))\n            .catch( function(err) {\n                if (err.response) {\n                    console.log(err.response)\n                    console.log(err.response.data)\n                    console.log(err.response.status)\n                    console.log(err.response.headers)\n                } else if (err.request) {\n                    console.log(err.request)\n                } else {\n                    console.log('Error', err.message);\n                }\n                console.log(err.config);\n            })\n        })\n        // .then( function(res) {\n        //     for (let i = 0; i < 3; i++) {\n        //         tableArray.push(res[i])\n        //     } \n        //     console.log(tableArray)\n        //     setCreateTable(tableArray)\n        //     setVisible(true)\n        //     setButtonVisible(false)\n        // })\n    }\n\n    // const uploadFile = async (file) => {\n\n    //     const formData = new FormData();\n        \n    //     formData.append('file', file)\n        \n    //     let res =  await axios.post(FILE_UPLOAD_URL, formData, {\n    //         headers: {\n    //             'content-type': 'multipart/form-data'\n    //         }\n\t// \t})\n\t// \treturn res\n    // }\n    \n    const onSubmit = async (e) => {\n        // let res = await uploadFile(file);\n        // console.log(res.data);\n        // checkedLanguages = []\n        // selectedOptions = []\n        // message.success('Your file was successfully submitted and is now being processed')\n\t}\n      \n    const onCheck = event => {\n        checkedLanguages.push(event.target.value)\n        setLanguages(prevLanguages => prevLanguages.concat(checkedLanguages))\n    }\n\n    // const onSelect = event => {\n    //     selectedOptions.push(event.value)\n    //     console.log(selectedOptions)\n    // }\n    \n    const renderLanguages = () => {\n        const languages = ['English', 'Hindi', 'Tamil', 'Telugu', 'Kannada', 'Marathi', 'Gujarati', 'Bengali', 'Punjabi', 'Malayalam']\n\n        return (\n            <>\n                <Form.Item name=\"language\" label=\"Language\">\n                        { languages.map( language => (\n                            <Checkbox.Group className=\"pl-3 mt-1\">\n                                <Col>\n                                    <Checkbox value={ language } style={{ lineHeight: '32px' }} onChange={ onCheck }>{ language }</Checkbox>\n                                </Col>\n                            </Checkbox.Group>\n                        )) }\n                </Form.Item>\n            </>\n        )\n    }\n    \n    // const showTableHeaders = array => {\n\n    //     newArr = array[0]\n\n    //     console.log(newArr)\n        \n    //     return (\n    //         <>\n    //         { newArr.map( (num, index) => (\n    //             <Form.Item\n    //                 name={ num }\n    //                 label={ num }\n    //                 hasFeedback\n    //             >\n    //                 <Row>\n    //                     <Select key={ index } labelInValue placeholder={`Please enter ${ num }`} onSelect={ onSelect }>\n    //                         { newArr.map( (num, index) => {\n    //                             return <Option key={ index } value={ num }>{ num }</Option>\n    //                         }) }\n    //                     </Select>\n    //                 </Row>\n    //             </Form.Item>\n    //         ))}\n    //         </>\n    //     )\n    // }\n\n    // --------------------------------------------------------------------- //\n    // --------------------------------------------------------------------- //\n    // --------------------------------------------------------------------- //\n\n\treturn (\n        <Form\n            name=\"validate_other\"\n            { ...formItemLayout }\n            onFinish={ onSubmit }\n            textAlign=\"center\"\n            style={ buttonVisible ? { height: '500px' } : { height: '100%' }}\n        >\n\t\t\t<Form.Item justify=\"center\" style={{ textAlign: 'center', marginTop: '1%', marginBottom: '1%' }}>\n                <Title level={1}>Upload Transactions</Title>\n            </Form.Item>\n            <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n                { checked && <Button htmlType=\"submit\" variant=\"contained\" type=\"primary\" style={{ width: '100%', height: '3rem', fontSize: '1.45rem' }}>Create Transactions</Button> }\n            </Form.Item>\n            <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', textAlign: 'center' }}>\n\t\t\t    <input type=\"file\" onChange={ onChange } ref={ hiddenFileInput }  style={{ display: 'none' }} />\n                { buttonVisible ? showButtons() : <Title level={3}>Please map the headings</Title>}\n            </Form.Item>\n            <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }} className=\"mt-5\">\n                <Row>\n                    { renderLanguages() }\n                </Row>\n            </Form.Item>\n            {/* <Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }} className=\"mt-5\">\n                    <Row>\n                        { visible && showTableHeaders(createTable) }\n                    </Row>\n            </Form.Item> */}\n\t\t\t<Form.Item style={{ display: 'flex', justifyContent: 'center', alignItems: 'center' }}>\n                { visible && <Button htmlType=\"submit\" variant=\"contained\" type=\"primary\" style={{ width: '100%', height: '3rem', fontSize: '1.45rem' }}>Create Transactions</Button> }\n            </Form.Item>\n            {/* { show && <div id=\"print_here\"></div>} */}\n\t\t</Form>\n\t)\n        \n}\nexport default FileUploadForm"]},"metadata":{},"sourceType":"module"}